as.matrix() %>%
sirt(names(.))
interaction_matrix_og <- interactions %>%
filter(Treatment3 == "old-growth forest") %>%
count(animal_species, plant_species) %>%
pivot_wider(names_from = plant_species,
values_from = n,
values_fill = 0) %>%
arrange(animal_species) %>%
column_to_rownames("animal_species") %>%
as.matrix() %>%
sort(names(.))
interaction_matrix_og <- interactions %>%
filter(Treatment3 == "old-growth forest") %>%
count(animal_species, plant_species) %>%
pivot_wider(names_from = plant_species,
values_from = n,
values_fill = 0) %>%
arrange(animal_species) %>%
column_to_rownames("animal_species") %>%
as.matrix() %>%
select(sort(names(.)))
interaction_matrix_og <- interactions %>%
filter(Treatment3 == "old-growth forest") %>%
count(animal_species, plant_species) %>%
pivot_wider(names_from = plant_species,
values_from = n,
values_fill = 0) %>%
arrange(animal_species, plant_species) %>%
column_to_rownames("animal_species")
as.matrix()
interaction_matrix_og <- interactions %>%
filter(Treatment3 == "old-growth forest") %>%
count(animal_species, plant_species) %>%
pivot_wider(names_from = plant_species,
values_from = n,
values_fill = 0) %>%
arrange(animal_species, plant_species) %>%
column_to_rownames("animal_species") %>%
as.matrix()
interaction_matrix_og <- interactions %>%
filter(Treatment3 == "old-growth forest") %>%
count(animal_species, plant_species) %>%
pivot_wider(names_from = plant_species,
values_from = n,
values_fill = 0) %>%
# arrange(animal_species, plant_species) %>%
column_to_rownames("animal_species") %>%
as.matrix()
interaction_matrix_og <- interactions %>%
filter(Treatment3 == "old-growth forest") %>%
arrange(plant_species) %>%
count(animal_species, plant_species) %>%
pivot_wider(names_from = plant_species,
values_from = n,
values_fill = 0) %>%
column_to_rownames("animal_species") %>%
as.matrix()
interaction_matrix_og <- interactions %>%
filter(Treatment3 == "old-growth forest") %>%
arrange(plant_species) %>%
count(animal_species, plant_species) %>%
pivot_wider(names_from = plant_species,
values_from = n,
values_fill = 0) %>%
column_to_rownames("animal_species") %>%
as.matrix()
interaction_matrix_og <- interactions %>%
filter(Treatment3 == "old-growth forest") %>%
count(animal_species, plant_species) %>%
pivot_wider(names_from = plant_species,
values_from = n,
values_fill = 0) %>%
column_to_rownames("animal_species") %>%
as.matrix() %>%
select(sort(names(.)))
interaction_matrix_og <- interactions %>%
filter(Treatment3 == "old-growth forest") %>%
count(animal_species, plant_species) %>%
pivot_wider(names_from = plant_species,
values_from = n,
values_fill = 0) %>%
column_to_rownames("animal_species") %>%
select(sort(names(.))) %>%
as.matrix()
interaction_matrix_og <- interactions %>%
filter(Treatment3 == "old-growth forest") %>%
count(animal_species, plant_species) %>%
pivot_wider(names_from = plant_species,
values_from = n,
values_fill = 0) %>%
column_to_rownames("animal_species") %>%
select(sort(names(.))) %>%
as.matrix()
# Plot using bipartite
svg("og_network.svg", width = 0.394 * 20, height = 0.394 * 5*3)
plotweb(interaction_matrix_og, method = "normal",
col.high = "#19401b",
bor.col.high = "#19401b",
col.low = "#d29500",
bor.col.low = "#d29500",
col.interaction = "#2e6ca4",
bor.col.interaction = "#2e6ca4",
text.rot = 90)
dev.off()
interaction_matrix_rl <- interactions %>%
filter(Treatment3 == "regeneration late") %>%
count(animal_species, plant_species) %>%
pivot_wider(names_from = plant_species,
values_from = n,
values_fill = 0) %>%
column_to_rownames("animal_species") %>%
select(sort(names(.))) %>%
as.matrix()
plotweb(interaction_matrix_og, method = "normal",
col.high = "#19401b",
bor.col.high = "#19401b",
col.low = "#d29500",
bor.col.low = "#d29500",
col.interaction = "#2e6ca4",
bor.col.interaction = "#2e6ca4",
text.rot = 90)
plotweb(interaction_matrix_lr, method = "normal",
col.high = "#19401b",
bor.col.high = "#19401b",
col.low = "#d29500",
bor.col.low = "#d29500",
col.interaction = "#2e6ca4",
bor.col.interaction = "#2e6ca4",
text.rot = 90)
interaction_matrix_rl <- interactions %>%
filter(Treatment3 == "regeneration late") %>%
count(animal_species, plant_species) %>%
pivot_wider(names_from = plant_species,
values_from = n,
values_fill = 0) %>%
column_to_rownames("animal_species") %>%
select(sort(names(.))) %>%
as.matrix()
plotweb(interaction_matrix_rl, method = "normal",
col.high = "#19401b",
bor.col.high = "#19401b",
col.low = "#d29500",
bor.col.low = "#d29500",
col.interaction = "#2e6ca4",
bor.col.interaction = "#2e6ca4",
text.rot = 90)
# Plot using bipartite
svg("late_network.svg", width = 0.394 * 20, height = 0.394 * 5*3)
plotweb(interaction_matrix_rl, method = "normal",
col.high = "#19401b",
bor.col.high = "#19401b",
col.low = "#d29500",
bor.col.low = "#d29500",
col.interaction = "#2e6ca4",
bor.col.interaction = "#2e6ca4",
text.rot = 90)
dev.off()
interaction_matrix_re <- interactions %>%
filter(Treatment3 == "regeneration early") %>%
filter(RegTime != 0) %>%
count(animal_species, plant_species) %>%
pivot_wider(names_from = plant_species,
values_from = n,
values_fill = 0) %>%
column_to_rownames("animal_species") %>%
select(sort(names(.))) %>%
as.matrix()
plotweb(interaction_matrix_re, method = "normal",
col.high = "#19401b",
bor.col.high = "#19401b",
col.low = "#d29500",
bor.col.low = "#d29500",
col.interaction = "#2e6ca4",
bor.col.interaction = "#2e6ca4",
text.rot = 90)
# Plot using bipartite
svg("early_network.svg", width = 0.394 * 20, height = 0.394 * 5*3)
plotweb(interaction_matrix_re, method = "normal",
col.high = "#19401b",
bor.col.high = "#19401b",
col.low = "#d29500",
bor.col.low = "#d29500",
col.interaction = "#2e6ca4",
bor.col.interaction = "#2e6ca4",
text.rot = 90)
dev.off()
interaction_matrix_active <- interactions %>%
# filter(Treatment3 == "regeneration early") %>%
filter(RegTime == 0) %>%
count(animal_species, plant_species) %>%
pivot_wider(names_from = plant_species,
values_from = n,
values_fill = 0) %>%
column_to_rownames("animal_species") %>%
select(sort(names(.))) %>%
as.matrix()
plotweb(interaction_matrix_active, method = "normal",
col.high = "#19401b",
bor.col.high = "#19401b",
col.low = "#d29500",
bor.col.low = "#d29500",
col.interaction = "#2e6ca4",
bor.col.interaction = "#2e6ca4",
text.rot = 90)
nrow(int)
nrow(interactions)
interactions <- interactions %>%
left_join(animals_traits, by = "animal_species") %>%
left_join(plants_traits, by = "plant_species") %>%
filter(!animal_species %in% c("", "Metachirus_sp", "Trasandinomys_sp", "Trogon_sp.")) %>%
filter(!plant_species %in% c("Theobroma_cacao", "Manihot_esculenta", "Artocarpus_heterophyllus", "Psidium_guajava",
"Borojoa_sp.", "Persea_americana"))
interaction_matrix_og <- interactions %>%
filter(Treatment3 == "old-growth forest") %>%
count(animal_species, plant_species) %>%
pivot_wider(names_from = plant_species,
values_from = n,
values_fill = 0) %>%
column_to_rownames("animal_species") %>%
select(sort(names(.))) %>%
as.matrix()
interaction_matrix_rl <- interactions %>%
filter(Treatment3 == "regeneration late") %>%
count(animal_species, plant_species) %>%
pivot_wider(names_from = plant_species,
values_from = n,
values_fill = 0) %>%
column_to_rownames("animal_species") %>%
select(sort(names(.))) %>%
as.matrix()
interaction_matrix_re <- interactions %>%
filter(Treatment3 == "regeneration early") %>%
filter(RegTime != 0) %>%
count(animal_species, plant_species) %>%
pivot_wider(names_from = plant_species,
values_from = n,
values_fill = 0) %>%
column_to_rownames("animal_species") %>%
select(sort(names(.))) %>%
as.matrix()
interaction_matrix_active <- interactions %>%
# filter(Treatment3 == "regeneration early") %>%
filter(RegTime == 0) %>%
count(animal_species, plant_species) %>%
pivot_wider(names_from = plant_species,
values_from = n,
values_fill = 0) %>%
column_to_rownames("animal_species") %>%
select(sort(names(.))) %>%
as.matrix()
plotweb(interaction_matrix_active, method = "normal",
col.high = "#19401b",
bor.col.high = "#19401b",
col.low = "#d29500",
bor.col.low = "#d29500",
col.interaction = "#2e6ca4",
bor.col.interaction = "#2e6ca4",
text.rot = 90)
# Plot using bipartite
svg("active_network.svg", width = 0.394 * 20, height = 0.394 * 5*3)
plotweb(interaction_matrix_active, method = "normal",
col.high = "#19401b",
bor.col.high = "#19401b",
col.low = "#d29500",
bor.col.low = "#d29500",
col.interaction = "#2e6ca4",
bor.col.interaction = "#2e6ca4",
text.rot = 90)
dev.off()
plotweb(interaction_matrix_early, method = "normal",
col.high = "#19401b",
bor.col.high = "#19401b",
col.low = "#d29500",
bor.col.low = "#d29500",
col.interaction = "#2e6ca4",
bor.col.interaction = "#2e6ca4",
text.rot = 90)
plotweb(interaction_matrix_early, method = "normal",
col.high = "#19401b",
bor.col.high = "#19401b",
col.low = "#d29500",
bor.col.low = "#d29500",
col.interaction = "#2e6ca4",
bor.col.interaction = "#2e6ca4",
text.rot = 90)
plotweb(interaction_matrix_re, method = "normal",
col.high = "#19401b",
bor.col.high = "#19401b",
col.low = "#d29500",
bor.col.low = "#d29500",
col.interaction = "#2e6ca4",
bor.col.interaction = "#2e6ca4",
text.rot = 90)
# Plot using bipartite
svg("early_network.svg", width = 0.394 * 20, height = 0.394 * 5*3)
plotweb(interaction_matrix_re, method = "normal",
col.high = "#19401b",
bor.col.high = "#19401b",
col.low = "#d29500",
bor.col.low = "#d29500",
col.interaction = "#2e6ca4",
bor.col.interaction = "#2e6ca4",
text.rot = 90)
dev.off()
plotweb(interaction_matrix_rl, method = "normal",
col.high = "#19401b",
bor.col.high = "#19401b",
col.low = "#d29500",
bor.col.low = "#d29500",
col.interaction = "#2e6ca4",
bor.col.interaction = "#2e6ca4",
text.rot = 90)
# Plot using bipartite
svg("late_network.svg", width = 0.394 * 20, height = 0.394 * 5*3)
plotweb(interaction_matrix_rl, method = "normal",
col.high = "#19401b",
bor.col.high = "#19401b",
col.low = "#d29500",
bor.col.low = "#d29500",
col.interaction = "#2e6ca4",
bor.col.interaction = "#2e6ca4",
text.rot = 90)
dev.off()
plotweb(interaction_matrix_og, method = "normal",
col.high = "#19401b",
bor.col.high = "#19401b",
col.low = "#d29500",
bor.col.low = "#d29500",
col.interaction = "#2e6ca4",
bor.col.interaction = "#2e6ca4",
text.rot = 90)
# Plot using bipartite
svg("og_network.svg", width = 0.394 * 20, height = 0.394 * 5*3)
plotweb(interaction_matrix_og, method = "normal",
col.high = "#19401b",
bor.col.high = "#19401b",
col.low = "#d29500",
bor.col.low = "#d29500",
col.interaction = "#2e6ca4",
bor.col.interaction = "#2e6ca4",
text.rot = 90)
dev.off()
# Plot using bipartite
# svg("og_network.svg", width = 0.394 * 20, height = 0.394 * 5*3)
plotweb(interaction_matrix_og, method = "normal",
col.high = "#19401b",
bor.col.high = "#19401b",
col.low = "#d29500",
bor.col.low = "#d29500",
col.interaction = "#2e6ca4",
bor.col.interaction = "#2e6ca4",
text.rot = 90)
# Plot using bipartite
# svg("og_network.svg", width = 0.394 * 20, height = 0.394 * 5*3)
plotweb(interaction_matrix_lr, method = "normal",
col.high = "#19401b",
bor.col.high = "#19401b",
col.low = "#d29500",
bor.col.low = "#d29500",
col.interaction = "#2e6ca4",
bor.col.interaction = "#2e6ca4",
text.rot = 90)
# Plot using bipartite
# svg("og_network.svg", width = 0.394 * 20, height = 0.394 * 5*3)
plotweb(interaction_matrix_lr, method = "normal",
col.high = "#19401b",
bor.col.high = "#19401b",
col.low = "#d29500",
bor.col.low = "#d29500",
col.interaction = "#2e6ca4",
bor.col.interaction = "#2e6ca4",
text.rot = 90)
# Plot using bipartite
# svg("og_network.svg", width = 0.394 * 20, height = 0.394 * 5*3)
plotweb(interaction_matrix_rl, method = "normal",
col.high = "#19401b",
bor.col.high = "#19401b",
col.low = "#d29500",
bor.col.low = "#d29500",
col.interaction = "#2e6ca4",
bor.col.interaction = "#2e6ca4",
text.rot = 90)
# Plot using bipartite
# svg("og_network.svg", width = 0.394 * 20, height = 0.394 * 5*3)
plotweb(interaction_matrix_re, method = "normal",
col.high = "#19401b",
bor.col.high = "#19401b",
col.low = "#d29500",
bor.col.low = "#d29500",
col.interaction = "#2e6ca4",
bor.col.interaction = "#2e6ca4",
text.rot = 90)
# Plot using bipartite
# svg("og_network.svg", width = 0.394 * 20, height = 0.394 * 5*3)
plotweb(interaction_matrix_active, method = "normal",
col.high = "#19401b",
bor.col.high = "#19401b",
col.low = "#d29500",
bor.col.low = "#d29500",
col.interaction = "#2e6ca4",
bor.col.interaction = "#2e6ca4",
text.rot = 90)
View(as.data.frame(colSums(interaction_matrix_active)))
View(as.data.frame(rowSums(interaction_matrix_active)))
View(as.data.frame(rowSums(interaction_matrix_re)))
# Plot using bipartite
# svg("og_network.svg", width = 0.394 * 20, height = 0.394 * 5*3)
plotweb(interaction_matrix_active, method = "normal",
col.high = "#19401b",
bor.col.high = "#19401b",
col.low = "#d29500",
bor.col.low = "#d29500",
col.interaction = "#2e6ca4",
bor.col.interaction = "#2e6ca4",
text.rot = 90)
# Plot using bipartite
# svg("og_network.svg", width = 0.394 * 20, height = 0.394 * 5*3)
plotweb(interaction_matrix_er, method = "normal",
col.high = "#19401b",
bor.col.high = "#19401b",
col.low = "#d29500",
bor.col.low = "#d29500",
col.interaction = "#2e6ca4",
bor.col.interaction = "#2e6ca4",
text.rot = 90)
# Plot using bipartite
# svg("og_network.svg", width = 0.394 * 20, height = 0.394 * 5*3)
plotweb(interaction_matrix_re, method = "normal",
col.high = "#19401b",
bor.col.high = "#19401b",
col.low = "#d29500",
bor.col.low = "#d29500",
col.interaction = "#2e6ca4",
bor.col.interaction = "#2e6ca4",
text.rot = 90)
View(as.data.frame(rowSums(interaction_matrix_og)))
View(as.data.frame(rowSums(interaction_matrix_og)))
View(as.data.frame(colSums(interaction_matrix_og)))
# Plot using bipartite
# svg("og_network.svg", width = 0.394 * 20, height = 0.394 * 5*3)
plotweb(interaction_matrix_og, method = "normal",
col.high = "#19401b",
bor.col.high = "#19401b",
col.low = "#d29500",
bor.col.low = "#d29500",
col.interaction = "#2e6ca4",
bor.col.interaction = "#2e6ca4",
text.rot = 90)
interaction_matrix_rl <- interactions %>%
filter(Treatment3 == "regeneration late") %>%
count(animal_species, plant_species) %>%
pivot_wider(names_from = plant_species,
values_from = n,
values_fill = 0) %>%
column_to_rownames("animal_species") %>%
select(sort(names(.))) %>%
as.matrix()
View(as.data.frame(colSums(interaction_matrix_rl)))
View(as.data.frame(rowSums(interaction_matrix_rl)))
View(as.data.frame(colSums(interaction_matrix_re)))
View(as.data.frame(colSums(interaction_matrix_active)))
# Plot using bipartite
# svg("og_network.svg", width = 0.394 * 20, height = 0.394 * 5*3)
plotweb(interaction_matrix_lr, method = "normal",
col.high = "#19401b",
bor.col.high = "#19401b",
col.low = "#d29500",
bor.col.low = "#d29500",
col.interaction = "#2e6ca4",
bor.col.interaction = "#2e6ca4",
text.rot = 90)
# Plot using bipartite
# svg("og_network.svg", width = 0.394 * 20, height = 0.394 * 5*3)
plotweb(interaction_matrix_rl, method = "normal",
col.high = "#19401b",
bor.col.high = "#19401b",
col.low = "#d29500",
bor.col.low = "#d29500",
col.interaction = "#2e6ca4",
bor.col.interaction = "#2e6ca4",
text.rot = 90)
View(as.data.frame(rowSums(interaction_matrix_og)))
View(as.data.frame(colSums(interaction_matrix_og)))
# Plot using bipartite
# svg("og_network.svg", width = 0.394 * 20, height = 0.394 * 5*3)
plotweb(interaction_matrix_og, method = "normal",
col.high = "#19401b",
bor.col.high = "#19401b",
col.low = "#d29500",
bor.col.low = "#d29500",
col.interaction = "#2e6ca4",
bor.col.interaction = "#2e6ca4",
text.rot = 90)
# Get species exclusive to each treatment
exclusive_long_animals <- unique_animals_t3 %>%
group_by(animal_species) %>%
mutate(n_treatments = n_distinct(Treatment3)) %>%
filter(n_treatments == 1) %>%  # Keep only exclusives
ungroup() %>%
select(Treatment3, animal_species) %>%
arrange(Treatment3, animal_species)  # Sort for clarity
View(exclusive_long_animals)
shared_long_animals <- unique_animals_t3 %>%
group_by(animal_species) %>%
filter(n_distinct(Treatment3) == 3) %>%  # Species in all treatments
ungroup() %>%
distinct(animal_species) %>%             # Remove duplicates
mutate(present_in = "all_treatments")    # Add context column
View(shared_long_animals)
View(as.data.frame(colSums(interaction_matrix_active)))
interaction_matrix_active
